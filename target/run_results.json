{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2025-04-25T01:43:53.647376Z", "invocation_id": "912e81d0-3ec0-4bc9-94ad-deac24827c65", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T01:43:41.890274Z", "completed_at": "2025-04-25T01:43:41.912882Z"}, {"name": "execute", "started_at": "2025-04-25T01:43:41.912882Z", "completed_at": "2025-04-25T01:43:47.883230Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.992955923080444, "adapter_response": {"_message": "CREATE TABLE (100.0k rows, 46.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 100000, "bytes_processed": 48566536, "bytes_billed": 49283072, "location": "US", "project_id": "peppy-primacy-455413-d8", "job_id": "a518b3c5-81e6-4835-9e35-acd449ecf43b", "slot_ms": 8143}, "message": "CREATE TABLE (100.0k rows, 46.3 MiB processed)", "failures": null, "unique_id": "model.dbt_bq_glamira_dataset.change_data_type", "compiled": true, "compiled_code": "\n\nSELECT\n    currency,\n    SAFE_CAST(\n        REGEXP_REPLACE(\n            REPLACE(price, ',', '.'),\n            r'(\\d)\\.(\\d{3})(\\.\\d{2})', '$1$2$3'\n        ) AS FLOAT64\n    ) AS price,\n    _id,\n    TIMESTAMP_SECONDS(time_stamp) AS time_stamp,\n    SAFE.PARSE_DATETIME('%Y-%m-%d %H:%M:%S', local_time) AS local_time,  -- Added SAFE.PARSE for safety\n    SAFE_CAST(user_id_db AS INTEGER) AS user_id_db,  -- Convert to INTEGER\n    device_id,\n    ip,\n    user_agent,\n    resolution,\n    SAFE_CAST(api_version AS FLOAT64) AS api_version,  -- Convert to FLOAT64\n    SAFE_CAST(store_id AS INTEGER) AS store_id,  -- Convert to INTEGER\n    SAFE_CAST(product_id AS INTEGER) AS product_id,  -- Convert to INTEGER\n    SAFE_CAST(order_id AS INTEGER) AS order_id,  -- Convert to INTEGER\n    collection,\n    email_address,\n    current_url,\n    referrer_url,\n    recommendation,\n    utm_source,\n    utm_medium,\n    show_recommendation,\n    is_paypal,  -- No cast needed if already BOOLEAN\n    key_search,\n    SAFE_CAST(cat_id AS INTEGER) AS cat_id,  -- Convert to INTEGER\n    SAFE_CAST(collect_id AS INTEGER) AS collect_id,  -- Convert to INTEGER\n    SAFE_CAST(viewing_product_id AS INTEGER) AS viewing_product_id,  -- Convert to INTEGER\n    SAFE_CAST(recommendation_product_id AS INTEGER) AS recommendation_product_id,  -- Convert to INTEGER\n    SAFE_CAST(recommendation_clicked_position AS INTEGER) AS recommendation_clicked_position,\n    ARRAY(\n        SELECT AS STRUCT\n            SAFE_CAST(option_id AS INTEGER) AS option_id,  -- Convert to INTEGER\n            option_label,\n            quality,\n            quality_label,\n            SAFE_CAST(value_id AS INTEGER) AS value_id,  -- Convert to INTEGER\n            value_label,\n            alloy,\n            diamond,\n            SAFE_CAST(shapediamond AS INTEGER) AS shapediamond  -- Convert to INTEGER\n        FROM UNNEST(option)\n    ) AS option\n    ,\n    ARRAY(\n        SELECT AS STRUCT\n            SAFE_CAST(product_id AS INTEGER) AS product_id,  -- Convert to INTEGER\n            amount,\n            SAFE_CAST(\n                REGEXP_REPLACE(\n                    REPLACE(price, ',', '.'),\n                    r'(\\d)\\.(\\d{3})(\\.\\d{2})', '$1$2$3'\n                ) AS FLOAT64\n            ) AS price,\n            currency,\n            ARRAY(\n                SELECT AS STRUCT\n                    SAFE_CAST(option_id AS INTEGER) AS option_id,  -- Convert to INTEGER\n                    option_label,\n                    quality,\n                    quality_label,\n                    SAFE_CAST(value_id AS INTEGER) AS value_id,  -- Convert to INTEGER\n                    value_label,\n                    alloy,\n                    diamond,\n                    SAFE_CAST(shapediamond AS INTEGER) AS shapediamond  -- Convert to INTEGER\n                FROM UNNEST(option)\n            ) AS option\n        FROM UNNEST(cart_products)\n    ) AS cart_products\nFROM `peppy-primacy-455413-d8`.`summary`.`glamira_dataset`", "relation_name": "`peppy-primacy-455413-d8`.`summary_your_dataset`.`change_data_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T01:43:47.883230Z", "completed_at": "2025-04-25T01:43:47.883230Z"}, {"name": "execute", "started_at": "2025-04-25T01:43:47.883230Z", "completed_at": "2025-04-25T01:43:49.866468Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9832384586334229, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "peppy-primacy-455413-d8", "job_id": "b5e138d7-a53d-4e27-86e6-b6a5814f9410", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_glamira_dataset.example_model", "compiled": true, "compiled_code": "-- models/example_model.sql\r\nSELECT\r\n  \"Hello DBT!\" AS message", "relation_name": "`peppy-primacy-455413-d8`.`summary`.`example_model`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-25T01:43:49.866468Z", "completed_at": "2025-04-25T01:43:49.866468Z"}, {"name": "execute", "started_at": "2025-04-25T01:43:49.866468Z", "completed_at": "2025-04-25T01:43:53.596658Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7301900386810303, "adapter_response": {"_message": "CREATE TABLE (1.0k rows, 46.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1000, "bytes_processed": 48566536, "bytes_billed": 49283072, "location": "US", "project_id": "peppy-primacy-455413-d8", "job_id": "41b14457-9b02-41a3-9215-42a7dca27a66", "slot_ms": 4423}, "message": "CREATE TABLE (1.0k rows, 46.3 MiB processed)", "failures": null, "unique_id": "model.dbt_bq_glamira_dataset.my_first_dbt_model", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nSELECT\n    t.*\nFROM `peppy-primacy-455413-d8`.`summary`.`glamira_dataset` t\nCROSS JOIN UNNEST(t.option) AS opt\nWHERE opt.option_id IS NOT NULL\nLIMIT 1000\n\n\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null", "relation_name": "`peppy-primacy-455413-d8`.`summary`.`my_first_dbt_model`", "batch_results": null}], "elapsed_time": 14.83298659324646, "args": {"require_resource_names_without_spaces": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "select": [], "invocation_command": "dbt run", "profiles_dir": "C:\\Users\\Nam\\.dbt", "static_parser": true, "log_format_file": "debug", "indirect_selection": "eager", "require_nested_cumulative_type_params": false, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "favor_state": false, "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "partial_parse_file_diff": true, "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "project_dir": "C:\\Users\\Nam\\Documents\\Project06", "warn_error_options": {"include": [], "exclude": []}, "defer": false, "empty": false, "use_colors": true, "populate_cache": true, "partial_parse": true, "source_freshness_run_project_hooks": false, "strict_mode": false, "state_modified_compare_vars": false, "printer_width": 80, "vars": {}, "require_yaml_configuration_for_mf_time_spines": false, "which": "run", "macro_debugging": false, "log_path": "C:\\Users\\Nam\\Documents\\Project06\\logs", "print": true, "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760, "quiet": false, "write_json": true, "version_check": true, "log_level": "info", "introspect": true, "log_format": "default"}}